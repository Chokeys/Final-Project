<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>장바구니</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!--웹 페이지 아이콘 변경-->
    <link rel="icon" th:href="@{/image/specialday.ico}">
    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=DynaPuff&family=Permanent+Marker&display=swap"
        rel="stylesheet">
    <!--Bootstrap 용 CSS-->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!--CSS-->
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/basket/basket.css}">
    <!--Bootstrap 용 Icon CDN-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <!-- font awesome용 css CDN  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!--thymeleaf contextpath-->
    <link id="contextPathHolder" th:data-contextPath="${#httpServletRequest.getContextPath()}" />
</head>

<body>

    <!--header 영역-->
    <header th:replace="~{header :: headerFragment}"></header>

    <section class="cart">
        <div class="cart__information">
            <input type="hidden" value="${login.userid}" id="login_userid">
            <ul>
                <li>장바구니 상품은 최대 30일간 저장됩니다.</li>
                <li>장바구니에서 확인해야하는 정보로 추후 수정</li>
            </ul>
        </div>
        <table class="cart__list">

            <thead style="background-color: gainsboro;">
                <tr>
                    <td>
                        <div class="all_check_input_div">
                            <!-- <input type="checkbox" class="all_check_input input_size_20" checked="checked"> -->
                            <span class="all_chcek_span">전체선택</span>
                        </div>
                    </td>
                    <td>번호</td>
                    <td>클래스 이미지</td>
                    <td>클래스 신청 정보</td>
                    <td>인원수</td>
                    <td>결제 금액</td>
                </tr>
            </thead>
            <tbody>
                <form th:action="@{/member/basket.do}" method="post" id="form" name="frm">
                    <tr class="cart__list__detail" th:each="obj : ${list}" id="practice-3">
                        <td><input type="checkbox" name="chk[]" th:value="${obj.no.longValue()}"></td>
                        <td>
                            <th:block th:each="no : ${#numbers.sequence(1,1)}">
                                <div th:text="${obj.no.longValue()}" class="unit_no" name="unit_no">
                                </div>
                            </th:block>
                        </td>

                        <td>
                            <img th:src="@{/class/image(no=${obj.mainImg})}" style="width: 200px; height: 150px;">
                        </td>
                        <!-- classcode를 이용 해서 클래스 image를 띄우는 법-->
                        <td>
                            <a th:text="${obj.title}" href="#">수영 클래스</a>
                            <p th:text="${obj.classdate}" class="date"></p>
                            <p th:text="${obj.classstart}" class="starttime"></p>
                            <p th:text="${obj.classend}" class="endtime"></p>
                            <p th:text="${obj.classlavel}" class="level"></p>
                            <p th:text="${obj.totalprice}" id="num1" value="num1" class="addprice"></p>

                        </td>
                        <td>
                            <th:block th:if="${(obj.maximum-obj.cnt) > 0}">
                                <select>
                                    <option th:each="number : ${#numbers.sequence(1,obj.maximum-obj.cnt)}"
                                        th:text="${number}"></option>
                                </select>
                            </th:block>

                            <th:block th:if="${(obj.maximum-obj.cnt) le 0}">
                                <p>신청인원이 초과되었습니다.</p>
                            </th:block>
                        </td>
                        <td>
                            <p th:text="${obj.totalprice}" name="totalprice"></input><br>
                        </td>
                    </tr>
                </form>

                <tr class="cart__list__detail3">
                    <td>총합금액</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>
                        <span class="totalprice">30,000원</span><br>
                    </td>
                </tr>



                


            </tbody>

        </table>
        <button th:onclick="formAction1(1)" class="cart__list__optionbtn" type="button" id="order-bell2">선택상품
            삭제</button>
        <div class="cart__mainbtns">
            <button class="cart__bigorderbtn left" type="submit">쇼핑 계속하기</button>
            <input type="button" id="order-list" class="cart__bigorderbtn right"
                onclick="location.href='*/apply/insert.do';" value="결제화면으로" />
        </div>

    </section>

    <!--footer 영역-->
    <footer th:replace="~{footer :: footerFragment}"></footer>

    <!--jQuery-->
    <script th:src="@{/js/jquery-3.6.4.min.js}"></script>
    <!--axios library-->
    <script th:src="@{/js/axios.min.js}"></script>
    <!--Bootstrap 용 js -->
    <script th:src="@{/js/bootstrap.bundle.min.js}"></script>

    <script th:inline="javascript" type="text/javascript">

        const contextPath = $('#contextPathHolder').attr('data-contextPath');

        function formAction1(code) {
            const form = document.getElementById('form');
            if (code === 1) {
                form.action = /*[[@{/board2/updatebatch.pknu}]]*/'';
            }
            else if (code === 2) {
                form.action = /*[[@{/board2/deletebatch.pknu}]]*/'';
            }
            form.submit();
        }


    </script>

    <!--Main js-->
    <script th:src="@{/js/main.js}"></script>
</body>

</html>