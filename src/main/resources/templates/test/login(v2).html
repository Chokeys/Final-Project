<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>로그인</title>
	<link rel="stylesheet" href="style.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="${pageContext.request.contextPath}/resources/js/bootstrap.min.js"></script>
	<style>
		.form-floating>.form-control {
			height: 100%;
		}
	</style>
</head>

<body>
	<!-- 이전 버전-->
	<!-- <form class="login_form">
		<div class="main-container">
			<div class="main-wrap">
				<header>
					<div class="logo-wrap">
						<img src="/image/default.png">
					</div>
				</header>
				<section class="login-input-section-wrap">
					<div class="login-input-wrap">
						<input placeholder="아이디" type="text"></input>
					</div>
					<div class="login-input-wrap password-wrap">
						<input placeholder="비밀번호" type="password"></input>
					</div>
					<section class="Easy-sgin-in-wrap">
						<p class="password-reset">
							비밀번호 재설정 | 아이디찾기 | 회원가입</p>
					</section>
					<div class="login-button-wrap">
						<button>로그인</button>
					</div>
					<br />
				</section>

				<footer>

				</footer>
			</div>
		</div>
	</form> -->

	<!--main 영역-->
	<main>
		<div class="container mt-5">
			<div class="row justify-content-center">
				<div class="col-lg-5">
					<div class="card shadow-lg border-0 rounded-lg">
						<div class="card-header ">
							<h3 class="text-center font-weight-light my-4">로그인</h3>
						</div>
						<div class="card-body">
							<form id="form" th:action="@{/loginaction.do}" method="post">
								<div class="form-floating mb-4">
									<input id="id" class="form-control" type="text" placeholder="ID" name="id"
										value="test8">
									<label>아이디</label>
								</div>
								<div class="form-floating mb-4">
									<input id="pw" class="form-control" type="password" placeholder="Password"
										name="password" value="pw2">
									<label>패스워드</label>
								</div>
								<div class="d-flex align-items-center mt-4 mb-0">
									<!-- Controller -->
									<button class="btn btn-outline-success ms-auto" type="button"
										onclick="loginAction()">로그인</button>
									<!-- RestController -->
									<!-- <button class="btn btn-primary" type="button" onclick="ajaxLoginAction()">로그인</button> -->
								</div>
							</form>
						</div>
						<div class="card-footer text-center py-3">
							<a class="btn btn-outline-success" th:href="@{/member/join.do}">회원가입</a>
							<button class="btn btn-outline-success" type="button" onclick="findId()">아이디 찾기</button>
							<button class="btn btn-outline-success" type="button" onclick="findPw()">비밀번호 찾기</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!--modal 영역-->
	<!--아이디 찾기 modal-->
	<div class="modal fade" id="findIdModal" tabindex="-1" aria-labelledby="findIdModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-success text-white">
					<div class="me-auto"></div>
					<h5 class="modal-title" id="findIdModalLabel">아이디 찾기</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" style="height: 500px;">
					<div class="container">
						<div class="form-floating mb-4">
							<input type="text" name="modal_name" id="modal_name" class="form-control" value="test8" />
							<label for="name" class="form-label">등록하신 이름을 입력해주세요</label>
						</div>
						<div class="form-floating mb-4">
							<input type="text" name="modal_email" id="modal_email" class="form-control"
								value="test8@email.com" />
							<label for="email" class="form-label">등록하신 이메일을 입력해주세요</label>
						</div>
						<div class="form-floating mb-4">
							<input type="text" name="modal_phone" id="modal_phone" class="form-control"
								value="010-8888-0888" />
							<label for="phone" class="form-label">등록하신 전화번호를 입력해주세요</label>
						</div>
						<div id="printBox" class="mt-2" style="display:block;">
							<p class="text-center">입력하신 정보와 일치하는 아이디 목록입니다.</p>
							<div class="col border" style="height: 180px;">
								<div id="printId"></div>
								<button class="btn btn-primary">비밀번호 찾기</button>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<input type="button" class="btn btn-success" th:onclick="findIdAction()" value="아이디 찾기" />
					<button type="button" class="btn btn-secondary" onclick="resetAction()">취소</button>
				</div>
			</div>
		</div>
	</div>

	<!-- ****비밀번호 찾기 modal**** -->
	<!--modal1. 아이디 존재 유무 확인-->
	<div class="modal fade" id="findPwfirstModal" tabindex="-1" aria-labelledby="findPwfirstModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-success text-white">
					<div class="me-auto"></div>
					<h5 class="modal-title" id="findPwfirstModalLabel">비밀번호 찾기</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" style="height: 500px;">
					<h3 class="text-center mb-4">아이디 입력</h3>
					<div class="container">
						<div class="form-floating mb-4">
							<input type="text" name="modal_id" id="modal1_id" class="form-control" value="test8" />
							<label for="name" class="form-label">아이디를 입력해주세요</label>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<!-- <button class="btn btn-success" onclick="findPwIdCheck()">다음</button> -->
					<button class="btn btn-primary" data-bs-target="#findPwSecondModal" data-bs-toggle="modal">다음</button>
					<!-- <button type="button" class="btn btn-secondary" onclick="resetAction1()">취소</button> -->
				</div>
			</div>
		</div>
	</div>

	<!--modal2. 이메일 인증-->
	<div class="modal fade" id="findPwSecondModal" tabindex="-1" aria-labelledby="findPwSecondModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-success text-white">
					<div class="me-auto"></div>
					<h5 class="modal-title" id="findPwSecondModalLabel">비밀번호 찾기</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" style="height: 500px;">
					<h3 class="text-center mb-4">이메일 인증</h3>
					<div class="container">
						<div class="form-floating mb-4">
							<input type="text" name="modal_id" id="modal2_email" class="form-control"
								value="shmjo0604@gmail.com" />
							<label for="name" class="form-label">인증번호를 전송할 이메일을 입력해주세요</label>
							<button class="btn btn-success" onclick="findPwEmailAuth()">인증</button>
						</div>
					</div>
				</div>
				<div id="authbox" style="display:block;">
					<hr class="divider">
					인증번호 : <input id="modal2_authnum" type="text"> <span id="timer"></span> <button
						class="btn btn-outline-success" th:onclick="checkauthnum()">확인</button>
				</div>
				<div class="modal-footer">
					<button id="modal2_next" class="btn btn-primary" style="display: block;"
						data-bs-target="#findPwThirdModal" data-bs-toggle="modal">다음</button>
					<button type="button" class="btn btn-secondary" onclick="resetAction2()">취소</button>
				</div>
			</div>
		</div>
	</div>

	<!--modal3. 비밀번호 변경-->
	<div class="modal fade" id="findPwThirdModal" tabindex="-1" aria-labelledby="findPwThirdModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-success text-white">
					<div class="me-auto"></div>
					<h5 class="modal-title" id="findPwThirdModalLabel">비밀번호 찾기</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" style="height: 500px;">
					<h3 class="text-center mb-4">비밀번호 변경</h3>
					<div class="container">


						<div class="form-floating mb-4" style="display:block;">
							<input type="text" name="id" id="modal3_id" class="form-control" value="" />
							<!-- <label for="phone" class="form-label">등록하신 전화번호를 입력해주세요</label> -->
						</div>
						<div class="form-floating mb-4">
							<input type="password" name="password" id="modal3_password" class="form-control"
								value="pw2" />
							<label for="name" class="form-label">새 비밀번호를 입력해주세요</label>
						</div>
						<div class="form-floating mb-4">
							<input type="password" id="modal3_password1" class="form-control" value="pw2" />
							<label for="email" class="form-label">새 비밀번호를 한 번 더 입력해주세요</label>
						</div>

					</div>
				</div>
				<div class="modal-footer">
					<input type="button" class="btn btn-success" th:onclick="findPwAction()" value="확인" />
					<button type="button" class="btn btn-secondary" onclick="resetAction3()">취소</button>
				</div>
			</div>
		</div>
	</div>

	<!--jQuery-->
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
	<!--Bootstrap 용 js-->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		function loginAction() {
			const id = document.getElementById("id");
			const pw = document.getElementById("pw");
			const form = document.getElementById("form");

			if (id.value.length <= 0) {
				alert('아이디를 입력하세요');
				id.focus();
				return false;

			}
			if (pw.value.length <= 0) {
				alert('비밀번호를 입력하세요');
				pw.focus();
				return false;

			}

			form.submit();

		}

		function findId() {
			const modal = new bootstrap.Modal(document.getElementById("findIdModal"), {});
			modal.show();
		}

		function findPw() {
			const modal = new bootstrap.Modal(document.getElementById("findPwfirstModal"), {});
			modal.show();
		}

		function resetAction1() {
			$("#findPwfirstModal").modal('hide');
		}

		function resetAction2() {
			$("#findPwSecondModal").modal('hide');
		}

		function resetAction3() {
			$("#findPwThirdModal").modal('hide');
		}

		// function findPwIdCheck() {
		// 	$("#findPwSecondModal").modal('show');
		// }

		var timer = null;
        var isRunning = false;
        var timerstop = 1;

		function findPwEmailAuth() {

			var display = $("#timer");

			// 유효시간 설정
			var leftSec = 270;

			if (isRunning) {
				clearInterval(timer);
				display.html("");
				startTimer(leftSec, display);
			} else {
				startTimer(leftSec, display);
			}

		}

		function startTimer(count, display) {

			var minutes, seconds;

			timer = setInterval(function () {
				minutes = parseInt(count / 60, 10);
				seconds = parseInt(count % 60, 10);

				minutes = minutes < 10 ? "0" + minutes : minutes;
				seconds = seconds < 10 ? "0" + seconds : seconds;

				display.html(minutes + ":" + seconds);

				count--;

				// 타이머 시간 종료
				if (count < 0) {

					clearInterval(timer);
					alert("시간초과");
					display.html("시간초과");
					isRunning = false;

				}
			}, 1000);

			isRunning = true;
		}
	</script>
</body>

</html>